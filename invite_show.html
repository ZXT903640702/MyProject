<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
		<title>邀请中心</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="black" name="apple-mobile-web-app-status-bar-style">
		<meta content="telephone=no" name="format-detection">
		<meta content="email=no" name="format-detection">
		<script src="js/jquery-1.9.1.min.js" type="text/javascript"></script>
		<link rel="stylesheet" href="css/reset.css"/>
		<link rel="stylesheet" href="css/invite.css"/>
		<script src="js/canvas2image.js"></script>
		<style>
			.jq_img{
				position: fixed;
				top:60px;
				left:0;
				z-index: 100;
				width: 100%;
				height: 100%;
				background: #333;
				margin: 0 auto;
			}
			.jq_img img{
				margin: 10% auto;
			}

			/********************/
			.show_txt{
				position: fixed;
				bottom:80px;
				left:0;
				right:0;
				z-index: 9000;
				text-align: center;
				color:#00c7d3;
				font-size: 12px;
			}
			/********************/
		</style>
	</head>
	<body style="background: #333333;max-width: 750px;margin: 0 auto;">
		<!--tab-->
		<ul class="tab_ul">
			<li class="tab_act">
				<span>通用版</span>
				<p class="line_p"></p>
			</li>
			<li>
				<span>个人数据版</span>
				<p class="line_p"></p>
			</li>
		</ul>

		<div class="tab_box">
			<!--通用版-->
			<div class="item" style="display: block;">
				<!--存放模板截图-->
				<div class="mould_imgs"></div>

				<div class="mould_box">
					<!--模板1-->
					<div id="mould_item1" class="mitem" style="display: block;">
						<!--用户信息-->
						<div class="comf_user clearfix">
							<div class="header_img float_lf"><img src="img/comf_header.png" alt=""></div>
							<div class="float_lf">
								<p>Now !</p>
								<p>邀请你的加入</p>
							</div>
						</div>
						<div class="main_img">
							<img class="comf_mimg" src="img/comf_mould1.png" alt="">
							<!--logo-->
							<img class="comf_logo" src="img/comf_logo.png" alt="">
							<!--二维码-->
							<img class="comf_ewm" src="img/comf_ewm.png" alt="">
						</div>
					</div>
					<!--模板2-->
					<div id="mould_item2" class="mitem" style="display: none;">
						<div class="mould_bg">
							<img width="100%" src="img/mould_bg2.png" alt="">
							<!--用户信息-->
							<div class="comf_user clearfix">
								<div class="header_img float_lf"><img class="float_lf" src="img/comf_header.png" alt=""></div>
								<div class="float_lf">
									<p>Now !</p>
									<p>邀请你的加入</p>
								</div>
							</div>
							<div class="mould2_foot clearfix">
								<div class="float_lf">
									<p><img width="100%" src="img/comf_logo.png" alt=""></p>
									<p>赶快来注册吧！</p>
								</div>
								<div class="float_lf">
									<img width="100%" src="img/comf_ewm.png" alt="">
								</div>
							</div>
						</div>
					</div>
					<!--模板3-->
					<div id="mould_item3" class="mitem" style="display: none;">
						<div class="mould_bg">
							<img width="100%" src="img/mould_bg3.png" alt="">
							<!--用户信息-->
							<div class="comf_user">
								<div class="header_img"><img class="float_lf" src="img/comf_header.png" alt=""></div>
								<div>
									<p>Now !</p>
									<p class="clearfix">
										<img class="float_lf" src="img/line.png" alt="">
										<span class="float_lf">邀请你的加入</span>
										<img class="float_lf" src="img/line.png" alt="">
									</p>
								</div>
							</div>
							<div class="mould3_foot clearfix">
								<img src="img/comf_logo.png" alt="">
								<img src="img/comf_ewm.png" alt="">
								<p>还等什么，赶快来注册吧！</p>
							</div>
						</div>
					</div>
					<!--模板4-->
					<div id="mould_item4" class="mitem" style="display: none;">
						<div class="mould_bg">
							<img src="img/mould_bg4.png" alt="">
							<!--用户信息-->
							<div class="comf_user clearfix">
								<img class="float_rt" src="img/comf_header.png" alt="">
								<p class="float_rt">Now !</p>
							</div>
							<div class="comf_ewm">
								<img src="img/comf_ewm.png" alt="">
							</div>
						</div>
					</div>
					<!--模板5-->
					<div id="mould_item5" class="mitem" style="display: none;">
						<div class="mould_bg">
							<img width="100%" src="img/mould_bg5.png" alt="">
							<!--用户信息-->
							<div class="comf_user clearfix">
								<div class="header_img float_lf"><img src="img/comf_header.png" alt=""></div>
								<div class="float_lf">
									<p>Now !</p>
									<p>邀您读日报</p>
								</div>
							</div>
							<div class="comf_ewm5">
								<img src="img/comf_ewm.png" alt="">
							</div>
						</div>
					</div>
				</div>

				<!--底部模版切换-->
				<div class="find_nav">
					<div class="find_nav_left">
						<div class="find_nav_list" id="pagenavi1">


							<!--******************-->
							<div class="save_way">长按图片保存到本地,分享朋友圈</div>
							<!--******************-->


							<ul>
								<li>
									<a href="javascript:;" class="position-r">
										<img src="img/comf_img1.png" alt="">
										<img class="comf_act" style="display: block;" src="img/comf_act.png" alt="">
									</a>
								</li>
								<li>
									<a href="javascript:;" class="position-r">
										<img src="img/comf_img2.png" alt="">
										<img class="comf_act" src="img/comf_act.png" alt="">
									</a>
								</li>
								<li>
									<a href="javascript:;" class="position-r">
										<img src="img/comf_img3.png" alt="">
										<img class="comf_act" src="img/comf_act.png" alt="">
									</a>
								</li>
								<li>
									<a href="javascript:;" class="position-r">
										<img src="img/comf_img4.png" alt="">
										<img class="comf_act" src="img/comf_act.png" alt="">
									</a>
								</li>
								<li>
									<a href="javascript:;" class="position-r">
										<img src="img/comf_img5.png" alt="">
										<img class="comf_act" src="img/comf_act.png" alt="">
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<!--个人版-->
			<div class="item" style="min-height: 470px;display: none;">
				<div class="per_data">
					<!--用户信息-->
					<div class="user_info clearfix">
						<div class="float_lf"><img src="img/comf_header.png" alt=""></div>
						<p class="float_lf"><span>Now ! </span><span>的展业助手数据报告</span></p>
					</div>
					<!--数据统计-->
					<div class="data_box">
						<div class="data_item clearfix">
							<div class="bao_guang float_lf">
								<img src="img/baog_data.png" alt="">
								<p>曝光总量</p>
								<p class="data_num">5,489,312</p>
							</div>
							<div class="bao_guang float_rt">
								<img src="img/money_data.png" alt="">
								<p>为企业节省广告费用(元)</p>
								<p class="data_num">5,489,312</p>
							</div>
						</div>
						<!--绘图-->
						<div id="container1" class="echarts_box" style="height: 100%"></div>
						<div class="sp_bot">
							<div class="sp_line"><img src="img/bot_line.png" alt=""></div>
							<div class="sp_bot_info clearfix">
								<div class="float_lf"><img src="img/erweima.jpg" alt=""></div>
								<p class="float_lf">还等什么，<br/>赶快来注册使用吧！</p>
								<div class="float_rt"><img src="img/share_img.png" alt=""></div>
							</div>
						</div>
					</div>
				</div>

				<div class="fenxiang">
					<a href="javascript:;" download="11.png">立即分享</a>
				</div>
				<!--个人数据截图-->
				<div class="jq_img"></div>

			</div>
		</div>
		<!--加载中提示图片-->
		<div class="loading text-center" style="display: none;">
			<div class="clearfix">
				<img class="float_lf" src="img/loading.gif" alt="">
				<span class="float_lf">正在加载...</span>
			</div>
		</div>

		<!--**********************-->
		<!--分享提示信息-->
		<div class="show_txt">长按图片保存到本地，分享朋友圈</div>
		<!--**********************-->

		<script src="js/echarts.min.js"></script>
		<script src="js/html2canvas.min.js"></script>
		<!--页面转为图片-->
		<script>
            //tab切换
			$(".tab_ul li").click(function(){
			    var indexs = $(this).index();
			    $(this).addClass("tab_act").siblings().removeClass("tab_act");
			    $(".tab_box .item").eq(indexs).show().siblings().hide();
			    //如果个人数据页面第一次切换显示则截图 再次切换不会重复截图
			    if(indexs==1 && $(".jq_img").html()==""){
                    $(".loading").show();
                    setTimeout(function () {
                        var shareContent = $(".per_data")[0];//需要截图的包裹的（原生的）DOM 对象
                        var width = shareContent.offsetWidth; //获取dom 宽度
                        var height = shareContent.offsetHeight; //获取dom 高度
                        var canvas = document.createElement("canvas"); //创建一个canvas节点
                        var scale = 8; //定义任意放大倍数 支持小数
                        canvas.width = width * scale; //定义canvas 宽度 * 缩放
                        canvas.height = height * scale; //定义canvas高度 *缩放
                        canvas.getContext("2d").scale(scale, scale); //获取context,设置scale
                        var opts = {
                            scale: scale, // 添加的scale 参数
                            canvas: canvas, //自定义 canvas
                            // logging: true, //日志开关，便于查看html2canvas的内部执行流程
                            width: width, //dom 原始宽度
                            height: height,
                            useCORS: true // 【重要】开启跨域配置
                        };
                        html2canvas(shareContent, opts).then(function (canvas) {
                            var context = canvas.getContext('2d');
                            // 【重要】关闭抗锯齿
                            context.mozImageSmoothingEnabled = false;
                            context.webkitImageSmoothingEnabled = false;
                            context.msImageSmoothingEnabled = false;
                            context.imageSmoothingEnabled = false;
                            var img = Canvas2Image.convertToJPEG(canvas, canvas.width, canvas.height);
                            var imgdata = $(img).attr("src");
                            // $(".fenxiang a").attr('href', imgdata);
                            // $(".fenxiang a").attr('download', 'myjobdeer.png');
                            $(".jq_img").html("");
                            $(".jq_img").append(img);
                            $(".loading").hide();
                            err_box("长按图片保存至本地");
                        });
                    },900);
				}
			});

			//点击x隐藏弹框
			$(".del_a").click(function(){
				$(this).parent().hide();
			});

            //消息提示框
            function err_box(t){
                var boxs = $("<div class='err_box'>"+t+"</div>");
                $("body").append(boxs);
                set_time = setTimeout(function() {
                    $(".err_box").remove();
                }, 2000);
            }

         // 通用版js

			//初始加载将默认模板截图展示
			$(document).ready(function(){
                $(".loading").show();
                setTimeout(function(){
                    var shareContent = $("#mould_item1")[0];//需要截图的包裹的（原生的）DOM 对象
                    var width = shareContent.offsetWidth; //获取dom 宽度
                    var height = shareContent.offsetHeight; //获取dom 高度
                    var canvas = document.createElement("canvas"); //创建一个canvas节点
                    var scale = 8; //定义任意放大倍数 支持小数
                    canvas.width = width * scale; //定义canvas 宽度 * 缩放
                    canvas.height = height * scale; //定义canvas高度 *缩放
                    canvas.getContext("2d").scale(scale, scale); //获取context,设置scale
                    var opts = {
                        scale: scale, // 添加的scale 参数
                        canvas: canvas, //自定义 canvas
                        // logging: true, //日志开关，便于查看html2canvas的内部执行流程
                        width: width, //dom 原始宽度
                        height: height,
                        useCORS: true // 【重要】开启跨域配置
                    };

                    html2canvas(shareContent, opts).then(function (canvas) {
                        var context = canvas.getContext('2d');
                        // 【重要】关闭抗锯齿
                        context.mozImageSmoothingEnabled = false;
                        context.webkitImageSmoothingEnabled = false;
                        context.msImageSmoothingEnabled = false;
                        context.imageSmoothingEnabled = false;
                        var img = Canvas2Image.convertToJPEG(canvas, canvas.width, canvas.height);
                        var imgdata = $(img).attr("src");
                        // $(".fenxiang a").attr('href', imgdata);
                        // $(".fenxiang a").attr('download', 'myjobdeer.png');
                        $(".mould_imgs").html("");
                        $(".mould_imgs").append(img);
                        $(".loading").hide();
                    });
				},300)
			});

			//模板切换并截图展示 每次切换都是一次截图
			$("#pagenavi1 ul li a").click(function(){
			    var indexs = $(this).parent().index();
			    $(this).find(".comf_act").show();
			    $(this).parent().siblings("li").find(".comf_act").hide();
			    $(".mould_box .mitem").eq(indexs).show().siblings().hide();
                $(".mould_box .mitem").eq(indexs).css("border-radius","0");
                $(".loading").show();
				var shareContent = $("#mould_item"+(indexs+1))[0];//需要截图的包裹的（原生的）DOM 对象
				var width = shareContent.offsetWidth; //获取dom 宽度
				var height = shareContent.offsetHeight; //获取dom 高度
				var canvas = document.createElement("canvas"); //创建一个canvas节点
				var scale = 8; //定义任意放大倍数 支持小数
				canvas.width = width * scale; //定义canvas 宽度 * 缩放
				canvas.height = height * scale; //定义canvas高度 *缩放
				canvas.getContext("2d").scale(scale, scale); //获取context,设置scale
				var opts = {
					scale: scale, // 添加的scale 参数
					canvas: canvas, //自定义 canvas
					// logging: true, //日志开关，便于查看html2canvas的内部执行流程
					width: width, //dom 原始宽度
					height: height,
					useCORS: true // 【重要】开启跨域配置
				};

				html2canvas(shareContent, opts).then(function (canvas) {
					var context = canvas.getContext('2d');
					// 【重要】关闭抗锯齿
					context.mozImageSmoothingEnabled = false;
					context.webkitImageSmoothingEnabled = false;
					context.msImageSmoothingEnabled = false;
					context.imageSmoothingEnabled = false;
					var img = Canvas2Image.convertToJPEG(canvas, canvas.width, canvas.height);
					var imgdata = $(img).attr("src");
					// $(".fenxiang a").attr('href', imgdata);
					// $(".fenxiang a").attr('download', 'myjobdeer.png');
					$(".mould_imgs").html("");
					$(".mould_imgs").append(img);
					$(".loading").hide();
				});
			});

		</script>

		<!--绘制环形图-->
		<script>
            $(".tab_ul li").click(function(){
                var ind = $(this).index();
                if(ind==1){
                    var dom = document.getElementById("container1");
                    var myChart = echarts.init(dom);
                    option = {
                        tooltip: {
                            trigger: 'item',
                            formatter: "{a} <br/>{b}: {c} ({d}%)"
                        },
                        series: [{
                            name: '',
                            type: 'pie',
                            smooth:false,
                            minAngle:0,
                            avoidLabelOverlap: true,
                            radius: ['35%', '65%'],
                            center: ['50%', '60%'],
                            itemGap:10,
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{hr|}\n{c} ',
                                    position: 'left',
                                    verticalAlign: 'middle',
                                    textStyle:{
                                        color:'#fff',
                                        fontSize:16,
                                        position:'left'
                                    },
                                    rich: {
                                        b:{
                                            color:'#083258',
                                            fontSize:14
                                        },
                                        hr:{
                                            width: '100%',
                                            height: 5,
                                            alien:'center'
                                        }
                                    }
                                }
                            },
                            labelLine:{
                                normal: {
                                    length:10,
                                    position:'left',
                                    lineStyle:{
                                        width:2,
                                        type:'dotted'  //'dotted'虚线 'solid'实线
                                    }

                                }
                            },
                            data: [
                                {value: 5000, name: '阅读量'},
                                {value: 0, name: '转发量'},
                                {value: 6366, name: '发布量'},
                                {value: 18000, name: '商业机会'}
                            ],
                            itemStyle:{
                                borderWidth: 3,
                                borderColor: '#083258'
                            }
                        }],
                        color:['#7bfaff','#f85991','#dbdd55','#82ef24']
                    };
                    myChart.setOption(option);
				}
			});

		</script>
	</body>
</html>
